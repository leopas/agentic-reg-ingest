# =========================
# App / Runtime
# =========================
APP_NAME=agentic-reg-ingest
ENV=dev
TZ=America/Sao_Paulo
SERVER_HOST=0.0.0.0
SERVER_PORT=8000
DEBUG=true
LOG_LEVEL=INFO            # DEBUG|INFO|WARNING|ERROR
STRUCTURED_LOGS=true      # logs json

# =========================
# Google Programmable Search (CSE)
# =========================
GOOGLE_API_KEY=
GOOGLE_CX=
CSE_MAX_RESULTS=50
CSE_THROTTLE_QPS=2        # queries/second (respeite politicas)
CSE_USER_AGENT=AgenticRegIngest/1.0

# =========================
# LLM (Planner/Judge/Chat)
# OpenAI compatível (pode usar LM Studio/Ollama via OPENAI_BASE_URL)
# =========================
OPENAI_API_KEY=
OPENAI_BASE_URL=          # ex.: http://localhost:1234/v1  (opcional)
OPENAI_MODEL=gpt-4o-mini  # planner/judge/chat

# =========================
# Embeddings
# =========================
EMBED_PROVIDER=openai     # openai|azure|local
OPENAI_EMBEDDING_MODEL=text-embedding-3-small
EMBED_DIM=1536            # coerente com o modelo
# Para "local": mantenha OPENAI_BASE_URL apontando p/ seu servidor compat.

# =========================
# MySQL (cache transacional: chunk_manifest/chunk_store + agentic logs)
# =========================
MYSQL_HOST=localhost
MYSQL_PORT=3306
MYSQL_DB=agentic
MYSQL_USER=
MYSQL_PASSWORD=
MYSQL_CONN_POOL_SIZE=10

# =========================
# VectorDB (Qdrant)
# =========================
QDRANT_URL=http://localhost:6333
QDRANT_API_KEY=
RAG_COLLECTION=kb_regulatory

# =========================
# Agentic Search — políticas padrão
# Ajuste via plano/override quando precisar
# =========================
AGENTIC_MIN_APPROVED=8
AGENTIC_MAX_ITERATIONS=3
AGENTIC_MAX_QUERIES_PER_ITER=6
AGENTIC_BUDGET_CSE_CALLS=60

# Quality Gates (fase de busca/seleção)
GATES_MUST_TYPES=pdf,zip,html      # lista separada por vírgulas
GATES_MIN_ANCHOR_SIGNALS=0         # 0=exploratório; 1–3 mais exigente
GATES_MIN_SCORE=0.65
GATES_MAX_AGE_YEARS=3

# =========================
# Ingest / Chunking
# =========================
CHUNK_MAX_TOKENS=512
CHUNK_OVERLAP_TOKENS=50
CHUNK_MIN_TOKENS=100
ANCHOR_ENABLE=true                  # usar detecção de anchors
ANCHOR_MIN_SIGNALS=1                # para ingest (mais seletivo que busca)

# =========================
# Chat RAG
# =========================
CHAT_DEFAULT_MODE=grounded          # grounded|infer
CHAT_TOPK=8
CHAT_SCORE_THRESHOLD=               # vazio = sem threshold

# =========================
# CORS / Segurança
# =========================
CORS_ALLOW_ORIGINS=*
CORS_ALLOW_HEADERS=*
CORS_ALLOW_METHODS=GET,POST,OPTIONS
SEC_HEADERS=true

# =========================
# Observabilidade
# =========================
SENTRY_DSN=
OTEL_EXPORTER_OTLP_ENDPOINT=
OTEL_SERVICE_NAME=agentic-reg-ingest

# =========================
# Rede / Proxy (opcional)
# =========================
HTTP_PROXY=
HTTPS_PROXY=
NO_PROXY=localhost,127.0.0.1

# =========================
# Flags de Dev
# =========================
UI_ENABLE=true
CHAT_UI_ENABLE=true
